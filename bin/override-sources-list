#! /usr/bin/python -u
#
# Copyright 2009-2017 Canonical Ltd.  This software is licensed under the
# GNU Affero General Public License version 3 (see the file LICENSE).

"""Override sources.list in the chroot with a list of archives."""

from __future__ import print_function

__metaclass__ = type

from argparse import ArgumentParser
import sys

from lpbuildd.target.chroot import ChrootSetup


def main():
    parser = ArgumentParser(
        description="Override sources.list in the chroot.")
    parser.add_argument(
        "build_id", metavar="ID", help="update chroot for build ID")
    parser.add_argument(
        "archives", metavar="ARCHIVE", nargs="+", help="sources.list lines")
    args = parser.parse_args()

    print("Overriding sources.list in build-%s" % args.build_id)
    setup = ChrootSetup(args.build_id)
    setup.override_sources_list(args.archives)
    return 0


if __name__ == "__main__":
    sys.exit(main())
