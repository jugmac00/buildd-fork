#! /usr/bin/python -u
#
# Copyright 2009-2017 Canonical Ltd.  This software is licensed under the
# GNU Affero General Public License version 3 (see the file LICENSE).

"""Update a Debian-style chroot."""

from __future__ import print_function

__metaclass__ = type

from argparse import ArgumentParser
import sys

from lpbuildd.target.chroot import ChrootUpdater


def main():
    parser = ArgumentParser(description="Update a Debian-style chroot.")
    parser.add_argument(
        "--series", metavar="SERIES", help="update chroot for series SERIES")
    parser.add_argument(
        "--arch", metavar="ARCH", help="update chroot for architecture ARCH")
    parser.add_argument(
        "build_id", metavar="ID", help="update chroot for build ID")
    args = parser.parse_args()

    print("Updating debian chroot for build %s" % args.build_id)
    updater = ChrootUpdater(args.build_id, args.series, args.arch)
    updater.update()
    return 0


if __name__ == "__main__":
    sys.exit(main())
